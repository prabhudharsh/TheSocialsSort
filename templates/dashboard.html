<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - The Social Sort</title>
    <!-- Google Fonts Import -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Ubuntu+Sans:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- Link to the CSS file -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}">
</head>
<body>
    <!-- ===============================
         HEADER
         =============================== -->
    <header class="navbar">
        <div class="logo-container">
            <span class="logo-text">The Social Sort</span>
        </div>
        <div class="profile-icon">
            <a href="/profile">
                <img src="{{ url_for('static', filename='images/' + ('male.png' if gender == 'male' else 'female.png')) }}" alt="Profile">
            </a>
        </div>
    </header>

    <!-- ===============================
         MAIN CONTENT
         =============================== -->
    <main class="dashboard-container">
        <h1 class="dashboard-title">Before you begin.</h1>
        <p class="dashboard-text">
            Between the lessons learned and the words we say aloud, a silent story of our class is constantly being written. This project was born from a desire to read that story, to hold a mirror to our small world and glimpse the invisible reputations that shimmer around each name. It is a map of the unspoken, a quiet census of our shared experience.
        </p>
        <p class="dashboard-text">
            To keep this mirror true, your reflection must remain unseen. Every vote you cast is a nameless whisper, a choice that arrives without a shadow, its origin known only to you. This anonymity is our promise to you, the foundation of a fairness that allows for pure honesty, untainted by friendship or fear.
        </p>
        <p class="dashboard-text">
            So, we ask this of you: find a quiet moment, away from the influence of others. Let the noise of the hallway fade.
        </p>
        <p class="dashboard-text">
            Cast your vote when no oneâ€™s watching, for it is in the stillness of solitude that the most honest thoughts arise.
        </p>

        <!-- Button Group -->
        <div class="button-group">
            <button id="countdownBtn" class="btn-voting" disabled>
                Voting Begins in: <span id="timer">{{ time_left }}</span>
            </button>
            <a href="{{ url_for('user_list') }}" class="btn-secondary">Look Who Joined In</a>
        </div>
    </main>

    <!-- ===============================
         SCRIPT
         =============================== -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            let timeLeft = {{ time_left }};
            const timerSpan = document.getElementById('timer');
            const countdownBtn = document.getElementById('countdownBtn');

            function formatTime(seconds) {
                if (seconds <= 0) return "0s";
                
                let d = Math.floor(seconds / (3600 * 24));
                let h = Math.floor((seconds % (3600 * 24)) / 3600);
                let m = Math.floor((seconds % 3600) / 60);
                let s = Math.floor(seconds % 60);

                let parts = [];
                if (d > 0) parts.push(`${d}d`);
                if (h > 0) parts.push(`${h}h`);
                if (m > 0) parts.push(`${m}m`);
                if (s > 0 || parts.length === 0) parts.push(`${s}s`);
                
                return parts.join(' ');
            }

            if (timeLeft > 0) {
                timerSpan.textContent = formatTime(timeLeft);
                const countdown = setInterval(() => {
                    timeLeft--;
                    if (timeLeft > 0) {
                        timerSpan.textContent = formatTime(timeLeft);
                    } else {
                        clearInterval(countdown);
                        countdownBtn.textContent = "Start Voting";
                        countdownBtn.disabled = false;
                        timerSpan.textContent = "now!";
                    }
                }, 1000);
            } else {
                countdownBtn.textContent = "Start Voting";
                countdownBtn.disabled = false;
            }

            countdownBtn.onclick = () => {
                if (!countdownBtn.disabled) {
                    window.location.href = "/category";
                }
            };
        });
    </script>
</body>
</html>
